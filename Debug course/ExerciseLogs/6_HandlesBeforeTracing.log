Opened log file 'C:\temp\cppdebug\6_Handles.log'
0:000> g
ModLoad: 76220000 76280000   C:\Windows\SysWOW64\IMM32.DLL
ModLoad: 76c50000 76d1c000   C:\Windows\syswow64\MSCTF.dll
ModLoad: 71de0000 71e60000   C:\Windows\SysWOW64\UxTheme.dll
ModLoad: 71dc0000 71dd3000   C:\Windows\SysWOW64\dwmapi.dll
ModLoad: 53430000 5343d000   C:\Windows\SysWOW64\MFC100ENU.DLL
ModLoad: 74f80000 75bc9000   C:\Windows\syswow64\SHELL32.dll
ModLoad: 76800000 7695c000   C:\Windows\syswow64\ole32.dll
ModLoad: 03670000 037cc000   C:\Windows\SysWOW64\ole32.dll
ModLoad: 02080000 021dc000   C:\Windows\SysWOW64\ole32.dll
ModLoad: 76420000 764a3000   C:\Windows\syswow64\CLBCatQ.DLL
ModLoad: 75f30000 75fbf000   C:\Windows\syswow64\OLEAUT32.dll
(e60.1bd0): Break instruction exception - code 80000003 (first chance)
eax=7efd7000 ebx=00000000 ecx=00000000 edx=772cf4e2 esi=00000000 edi=00000000
eip=7724000c esp=0228fa34 ebp=0228fa60 iopl=0         nv up ei pl zr na pe nc
cs=0023  ss=002b  ds=002b  es=002b  fs=0053  gs=002b             efl=00000246
ntdll!DbgBreakPoint:
7724000c cc              int     3
0:002> ~* k

   0  Id: e60.23d4 Suspend: 1 Teb: 7efdd000 Unfrozen
ChildEBP RetAddr  
002ff1fc 764c0962 ntdll!ZwWaitForMultipleObjects+0x15
002ff298 7651162d KERNELBASE!WaitForMultipleObjectsEx+0x100
002ff2e0 76511921 kernel32!WaitForMultipleObjectsExImplementation+0xe0
002ff2fc 00361a66 kernel32!WaitForMultipleObjects+0x18
002ff31c 53642c8c BatteryMeter!CBatteryMeterDlg::OnCPUSelectorChanged+0x56 [d:\livemesh\sharingbin\cppdebug\exercises\6_handles\sources\batterymeter\batterymeterdlg.cpp @ 152]
002ff330 53642e51 mfc100u!_AfxDispatchCmdMsg+0x58 [f:\dd\vctools\vc7libs\ship\atlmfc\src\mfc\cmdtarg.cpp @ 112]
002ff34c 53676d36 mfc100u!CCmdTarget::OnCmdMsg+0x124 [f:\dd\vctools\vc7libs\ship\atlmfc\src\mfc\cmdtarg.cpp @ 381]
002ff370 536cc4cb mfc100u!CPropertySheet::OnCmdMsg+0x1d [f:\dd\vctools\vc7libs\ship\atlmfc\src\mfc\dlgprop.cpp @ 814]
002ff3a0 536cbc7f mfc100u!CWnd::OnNotify+0x7b [f:\dd\vctools\vc7libs\ship\atlmfc\src\mfc\wincore.cpp @ 2701]
002ff470 536cbbba mfc100u!CWnd::OnWndMsg+0x9e [f:\dd\vctools\vc7libs\ship\atlmfc\src\mfc\wincore.cpp @ 2093]
002ff490 536ca019 mfc100u!CWnd::WindowProc+0x24 [f:\dd\vctools\vc7libs\ship\atlmfc\src\mfc\wincore.cpp @ 2067]
002ff508 536ca2a5 mfc100u!AfxCallWndProc+0xb5 [f:\dd\vctools\vc7libs\ship\atlmfc\src\mfc\wincore.cpp @ 248]
002ff52c 535c0ddb mfc100u!AfxWndProc+0x37 [f:\dd\vctools\vc7libs\ship\atlmfc\src\mfc\wincore.cpp @ 410]
002ff574 76336238 mfc100u!AfxWndProcBase+0x56 [f:\dd\vctools\vc7libs\ship\atlmfc\src\mfc\afxstate.cpp @ 420]
002ff5a0 763368ea USER32!InternalCallWinProc+0x23
002ff618 7633cd1a USER32!UserCallWinProcCheckWow+0x109
002ff65c 7633cd81 USER32!SendMessageWorker+0x581
002ff680 71610523 USER32!SendMessageW+0x7f
002ff71c 716bed9d COMCTL32!CCSendNotify+0xc19
002ff75c 71665453 COMCTL32!CUpDown::Bump+0xba

   1  Id: e60.2070 Suspend: 1 Teb: 7efda000 Unfrozen
ChildEBP RetAddr  
02cdfa00 76341d7e USER32!NtUserMessageCall+0x15
02cdfa40 7633cd81 USER32!SendMessageWorker+0x3c6
02cdfa64 00361759 USER32!SendMessageW+0x7f
02cdfaa4 76513677 BatteryMeter!TemperatureAndBatteryUpdaterThread+0xc9 [d:\livemesh\sharingbin\cppdebug\exercises\6_handles\sources\batterymeter\batterymeterdlg.cpp @ 55]
02cdfab0 77269d42 kernel32!BaseThreadInitThunk+0xe
02cdfaf0 77269d15 ntdll!__RtlUserThreadStart+0x70
02cdfb08 00000000 ntdll!_RtlUserThreadStart+0x1b

#  2  Id: e60.1bd0 Suspend: 1 Teb: 7efd7000 Unfrozen
ChildEBP RetAddr  
0228fa30 772cf51e ntdll!DbgBreakPoint
0228fa60 76513677 ntdll!DbgUiRemoteBreakin+0x3c
0228fa6c 77269d42 kernel32!BaseThreadInitThunk+0xe
0228faac 77269d15 ntdll!__RtlUserThreadStart+0x70
0228fac4 00000000 ntdll!_RtlUserThreadStart+0x1b
0:002> ~0s
eax=00000000 ebx=002ff24c ecx=00000000 edx=00000000 esi=00000002 edi=00000000
eip=772500ed esp=002ff1fc ebp=002ff298 iopl=0         nv up ei pl nz na po nc
cs=0023  ss=002b  ds=002b  es=002b  fs=0053  gs=002b             efl=00000202
ntdll!ZwWaitForMultipleObjects+0x15:
772500ed 83c404          add     esp,4
0:000> kb
ChildEBP RetAddr  Args to Child              
002ff1fc 764c0962 00000002 002ff24c 00000000 ntdll!ZwWaitForMultipleObjects+0x15
002ff298 7651162d 002ff24c 002ff2c0 00000001 KERNELBASE!WaitForMultipleObjectsEx+0x100
002ff2e0 76511921 00000002 7efde000 00000001 kernel32!WaitForMultipleObjectsExImplementation+0xe0
002ff2fc 00361a66 00000002 002ff314 00000001 kernel32!WaitForMultipleObjects+0x18
002ff31c 53642c8c 002ff744 002ff3c8 002ffac0 BatteryMeter!CBatteryMeterDlg::OnCPUSelectorChanged+0x56 [d:\livemesh\sharingbin\cppdebug\exercises\6_handles\sources\batterymeter\batterymeterdlg.cpp @ 152]
002ff330 53642e51 000003ec 0000003d 004efd2e mfc100u!_AfxDispatchCmdMsg+0x58 [f:\dd\vctools\vc7libs\ship\atlmfc\src\mfc\cmdtarg.cpp @ 112]
002ff34c 53676d36 000003ec 0000fd2e 002ff394 mfc100u!CCmdTarget::OnCmdMsg+0x124 [f:\dd\vctools\vc7libs\ship\atlmfc\src\mfc\cmdtarg.cpp @ 381]
002ff370 536cc4cb 000003ec 004efd2e 002ff394 mfc100u!CPropertySheet::OnCmdMsg+0x1d [f:\dd\vctools\vc7libs\ship\atlmfc\src\mfc\dlgprop.cpp @ 814]
002ff3a0 536cbc7f 000003ec fffffd2e 002ff3c8 mfc100u!CWnd::OnNotify+0x7b [f:\dd\vctools\vc7libs\ship\atlmfc\src\mfc\wincore.cpp @ 2701]
002ff470 536cbbba 0000004e 000003ec 002ff744 mfc100u!CWnd::OnWndMsg+0x9e [f:\dd\vctools\vc7libs\ship\atlmfc\src\mfc\wincore.cpp @ 2093]
002ff490 536ca019 0000004e 000003ec 002ff744 mfc100u!CWnd::WindowProc+0x24 [f:\dd\vctools\vc7libs\ship\atlmfc\src\mfc\wincore.cpp @ 2067]
002ff508 536ca2a5 002ffac0 00150c70 0000004e mfc100u!AfxCallWndProc+0xb5 [f:\dd\vctools\vc7libs\ship\atlmfc\src\mfc\wincore.cpp @ 248]
002ff52c 535c0ddb 00150c70 0000004e 000003ec mfc100u!AfxWndProc+0x37 [f:\dd\vctools\vc7libs\ship\atlmfc\src\mfc\wincore.cpp @ 410]
002ff574 76336238 00150c70 0000004e 000003ec mfc100u!AfxWndProcBase+0x56 [f:\dd\vctools\vc7libs\ship\atlmfc\src\mfc\afxstate.cpp @ 420]
002ff5a0 763368ea 535c0d85 00150c70 0000004e USER32!InternalCallWinProc+0x23
002ff618 7633cd1a 00000000 535c0d85 00150c70 USER32!UserCallWinProcCheckWow+0x109
002ff65c 7633cd81 00bde200 00000000 535c0d85 USER32!SendMessageWorker+0x581
002ff680 71610523 00150c70 0000004e 000003ec USER32!SendMessageW+0x7f
002ff71c 716bed9d 006ef1c8 fffffd2e 002ff744 COMCTL32!CCSendNotify+0xc19
002ff75c 71665453 00000000 006ef1c8 004f0bbc COMCTL32!CUpDown::Bump+0xba
0:000> dd 002ff314 L2
002ff314  0000010c 00000108
0:000> !handle 10c F
Handle 10c
  Type         	Thread
  Attributes   	0
  GrantedAccess	0x1fffff:
         Delete,ReadControl,WriteDac,WriteOwner,Synch
         Terminate,Suspend,Alert,GetContext,SetContext,SetInfo,QueryInfo,SetToken,Impersonate,DirectImpersonate
  HandleCount  	2
  PointerCount 	4
  Name         	<none>
  Object Specific Information
    Thread Id   e60.141c
    Priority    10
    Base Priority 0
    Start Address 3619e0 BatteryMeter!CPUSwitcherThread
0:000> !handle 108 F
Could not duplicate handle 108, error 6
0:000> !error 6
Error code: (Win32) 0x6 (6) - The handle is invalid.
0:000> q
quit:
