Opened log file 'C:\temp\cppdebug\2_Deadlock.log'
0:002> g
(e00.1fc0): Break instruction exception - code 80000003 (first chance)
eax=7efa6000 ebx=00000000 ecx=00000000 edx=772cf4e2 esi=00000000 edi=00000000
eip=7724000c esp=0381f83c ebp=0381f868 iopl=0         nv up ei pl zr na pe nc
cs=0023  ss=002b  ds=002b  es=002b  fs=0053  gs=002b             efl=00000246
ntdll!DbgBreakPoint:
7724000c cc              int     3
0:006> ~*
   0  Id: e00.1b70 Suspend: 1 Teb: 7efdd000 Unfrozen
      Start: BatteryMeter!wWinMainCRTStartup (012721dc) 
      Priority: 0  Priority class: 32  Affinity: ff
   1  Id: e00.6dc Suspend: 1 Teb: 7efda000 Unfrozen
      Start: BatteryMeter!TemperatureAndBatteryUpdaterThread (01271690) 
      Priority: 0  Priority class: 32  Affinity: ff
   2  Id: e00.22c8 Suspend: 1 Teb: 7efd7000 Unfrozen
      Start: BatteryMeter!CPUSelectorThread (012719b0) 
      Priority: 0  Priority class: 32  Affinity: ff
   3  Id: e00.22c0 Suspend: 1 Teb: 7efaf000 Unfrozen
      Start: BatteryMeter!HardwareChangeDetectorThread (012719f0) 
      Priority: 0  Priority class: 32  Affinity: ff
   4  Id: e00.179c Suspend: 1 Teb: 7efac000 Unfrozen
      Start: BatteryMeter!LocationAwarenessThread (01271a30) 
      Priority: 0  Priority class: 32  Affinity: ff
   5  Id: e00.1854 Suspend: 1 Teb: 7efa9000 Unfrozen
      Start: BatteryMeter!TemperaturePropagationThread (01271a60) 
      Priority: 0  Priority class: 32  Affinity: ff
.  6  Id: e00.1fc0 Suspend: 1 Teb: 7efa6000 Unfrozen
      Start: ntdll!DbgUiRemoteBreakin (772cf4e2) 
      Priority: 0  Priority class: 32  Affinity: ff
0:006> ~* kb

   0  Id: e00.1b70 Suspend: 1 Teb: 7efdd000 Unfrozen
ChildEBP RetAddr  Args to Child              
0022ee58 764c0962 00000004 0022eea8 00000000 ntdll!ZwWaitForMultipleObjects+0x15
0022eef4 7651162d 0022eea8 0022ef1c 00000001 KERNELBASE!WaitForMultipleObjectsEx+0x100
0022ef3c 76511921 00000004 7efde000 00000001 kernel32!WaitForMultipleObjectsExImplementation+0xe0
0022ef58 01271b06 00000004 0022ef74 00000001 kernel32!WaitForMultipleObjects+0x18
0022ef84 524e2c8c 0022f3ac 0022f030 0022f728 BatteryMeter!CBatteryMeterDlg::OnCPUSelectorChanged+0x86 [d:\livemesh\sharingbin\cppdebug\exercises\2_deadlock\sources\batterymeter\batterymeterdlg.cpp @ 185]
0022ef98 524e2e51 000003ec 0000003d 004efd2e mfc100u!_AfxDispatchCmdMsg+0x58 [f:\dd\vctools\vc7libs\ship\atlmfc\src\mfc\cmdtarg.cpp @ 112]
0022efb4 52516d36 000003ec 0000fd2e 0022effc mfc100u!CCmdTarget::OnCmdMsg+0x124 [f:\dd\vctools\vc7libs\ship\atlmfc\src\mfc\cmdtarg.cpp @ 381]
0022efd8 5256c4cb 000003ec 004efd2e 0022effc mfc100u!CPropertySheet::OnCmdMsg+0x1d [f:\dd\vctools\vc7libs\ship\atlmfc\src\mfc\dlgprop.cpp @ 814]
0022f008 5256bc7f 000003ec fffffd2e 0022f030 mfc100u!CWnd::OnNotify+0x7b [f:\dd\vctools\vc7libs\ship\atlmfc\src\mfc\wincore.cpp @ 2701]
0022f0d8 5256bbba 0000004e 000003ec 0022f3ac mfc100u!CWnd::OnWndMsg+0x9e [f:\dd\vctools\vc7libs\ship\atlmfc\src\mfc\wincore.cpp @ 2093]
0022f0f8 5256a019 0000004e 000003ec 0022f3ac mfc100u!CWnd::WindowProc+0x24 [f:\dd\vctools\vc7libs\ship\atlmfc\src\mfc\wincore.cpp @ 2067]
0022f170 5256a2a5 0022f728 00070c32 0000004e mfc100u!AfxCallWndProc+0xb5 [f:\dd\vctools\vc7libs\ship\atlmfc\src\mfc\wincore.cpp @ 248]
0022f194 52460ddb 00070c32 0000004e 000003ec mfc100u!AfxWndProc+0x37 [f:\dd\vctools\vc7libs\ship\atlmfc\src\mfc\wincore.cpp @ 410]
0022f1dc 76336238 00070c32 0000004e 000003ec mfc100u!AfxWndProcBase+0x56 [f:\dd\vctools\vc7libs\ship\atlmfc\src\mfc\afxstate.cpp @ 420]
0022f208 763368ea 52460d85 00070c32 0000004e USER32!InternalCallWinProc+0x23
0022f280 7633cd1a 00000000 52460d85 00070c32 USER32!UserCallWinProcCheckWow+0x109
0022f2c4 7633cd81 01387160 00000000 52460d85 USER32!SendMessageWorker+0x581
0022f2e8 71610523 00070c32 0000004e 000003ec USER32!SendMessageW+0x7f
0022f384 716bed9d 004bbcd0 fffffd2e 0022f3ac COMCTL32!CCSendNotify+0xc19
0022f3c4 71665453 00000000 004bbcd0 00070c38 COMCTL32!CUpDown::Bump+0xba

   1  Id: e00.6dc Suspend: 1 Teb: 7efda000 Unfrozen
ChildEBP RetAddr  Args to Child              
02c2fb38 76341d7e 00070ca2 00000408 00000000 USER32!NtUserMessageCall+0x15
02c2fb78 7633cd81 013aede0 00000000 52460d85 USER32!SendMessageWorker+0x3c6
02c2fb9c 01271761 00070ca2 00000408 00000000 USER32!SendMessageW+0x7f
02c2fbdc 76513677 0022f728 02c2fc28 77269d42 BatteryMeter!TemperatureAndBatteryUpdaterThread+0xd1 [d:\livemesh\sharingbin\cppdebug\exercises\2_deadlock\sources\batterymeter\batterymeterdlg.cpp @ 60]
02c2fbe8 77269d42 0022f728 5c92f0f6 00000000 kernel32!BaseThreadInitThunk+0xe
02c2fc28 77269d15 01271690 0022f728 00000000 ntdll!__RtlUserThreadStart+0x70
02c2fc40 00000000 01271690 0022f728 00000000 ntdll!_RtlUserThreadStart+0x1b

   2  Id: e00.22c8 Suspend: 1 Teb: 7efd7000 Unfrozen
ChildEBP RetAddr  Args to Child              
00a3fec8 77268c44 00000120 00000000 00000000 ntdll!ZwWaitForSingleObject+0x15
00a3ff2c 77268b28 00000000 00000000 00000000 ntdll!RtlpWaitOnCriticalSection+0x13e
00a3ff54 012719cd 012754e8 00000000 76513677 ntdll!RtlEnterCriticalSection+0x150
00a3ff60 76513677 00000000 00a3ffac 77269d42 BatteryMeter!CPUSelectorThread+0x1d [d:\livemesh\sharingbin\cppdebug\exercises\2_deadlock\sources\batterymeter\batterymeterdlg.cpp @ 145]
00a3ff6c 77269d42 00000000 5ef3f372 00000000 kernel32!BaseThreadInitThunk+0xe
00a3ffac 77269d15 012719b0 00000000 00000000 ntdll!__RtlUserThreadStart+0x70
00a3ffc4 00000000 012719b0 00000000 00000000 ntdll!_RtlUserThreadStart+0x1b

   3  Id: e00.22c0 Suspend: 1 Teb: 7efaf000 Unfrozen
ChildEBP RetAddr  Args to Child              
00ccfd08 77268c44 00000124 00000000 00000000 ntdll!ZwWaitForSingleObject+0x15
00ccfd6c 77268b28 00000000 00000000 00000000 ntdll!RtlpWaitOnCriticalSection+0x13e
00ccfd94 01271a0d 01275500 00000000 76513677 ntdll!RtlEnterCriticalSection+0x150
00ccfda0 76513677 00000000 00ccfdec 77269d42 BatteryMeter!HardwareChangeDetectorThread+0x1d [d:\livemesh\sharingbin\cppdebug\exercises\2_deadlock\sources\batterymeter\batterymeterdlg.cpp @ 153]
00ccfdac 77269d42 00000000 5e9cf132 00000000 kernel32!BaseThreadInitThunk+0xe
00ccfdec 77269d15 012719f0 00000000 00000000 ntdll!__RtlUserThreadStart+0x70
00ccfe04 00000000 012719f0 00000000 00000000 ntdll!_RtlUserThreadStart+0x1b

   4  Id: e00.179c Suspend: 1 Teb: 7efac000 Unfrozen
ChildEBP RetAddr  Args to Child              
00eafa78 764c0816 0000011c 00000000 00eafac0 ntdll!ZwWaitForSingleObject+0x15
00eafae4 76511184 0000011c 0000ea60 00000000 KERNELBASE!WaitForSingleObjectEx+0x98
00eafafc 76511138 0000011c 0000ea60 00000000 kernel32!WaitForSingleObjectExImplementation+0x75
00eafb10 01271a4e 0000011c 0000ea60 76513677 kernel32!WaitForSingleObject+0x12
00eafb1c 76513677 00000000 00eafb68 77269d42 BatteryMeter!LocationAwarenessThread+0x1e [d:\livemesh\sharingbin\cppdebug\exercises\2_deadlock\sources\batterymeter\batterymeterdlg.cpp @ 163]
00eafb28 77269d42 00000000 5ebaf7b6 00000000 kernel32!BaseThreadInitThunk+0xe
00eafb68 77269d15 01271a30 00000000 00000000 ntdll!__RtlUserThreadStart+0x70
00eafb80 00000000 01271a30 00000000 00000000 ntdll!_RtlUserThreadStart+0x1b

   5  Id: e00.1854 Suspend: 1 Teb: 7efa9000 Unfrozen
ChildEBP RetAddr  Args to Child              
0370fd18 764c0816 00000114 00000000 0370fd60 ntdll!ZwWaitForSingleObject+0x15
0370fd84 76511184 00000114 00015f90 00000000 KERNELBASE!WaitForSingleObjectEx+0x98
0370fd9c 76511138 00000114 00015f90 00000000 kernel32!WaitForSingleObjectExImplementation+0x75
0370fdb0 01271a72 00000114 00015f90 0370fdcc kernel32!WaitForSingleObject+0x12
0370fdc0 76513677 00000114 0370fe0c 77269d42 BatteryMeter!TemperaturePropagationThread+0x12 [d:\livemesh\sharingbin\cppdebug\exercises\2_deadlock\sources\batterymeter\batterymeterdlg.cpp @ 170]
0370fdcc 77269d42 00000114 5d20f2d2 00000000 kernel32!BaseThreadInitThunk+0xe
0370fe0c 77269d15 01271a60 00000114 00000000 ntdll!__RtlUserThreadStart+0x70
0370fe24 00000000 01271a60 00000114 00000000 ntdll!_RtlUserThreadStart+0x1b

#  6  Id: e00.1fc0 Suspend: 1 Teb: 7efa6000 Unfrozen
ChildEBP RetAddr  Args to Child              
0381f838 772cf51e 5dd1f4b6 00000000 00000000 ntdll!DbgBreakPoint
0381f868 76513677 00000000 0381f8b4 77269d42 ntdll!DbgUiRemoteBreakin+0x3c
0381f874 77269d42 00000000 5dd1f46a 00000000 kernel32!BaseThreadInitThunk+0xe
0381f8b4 77269d15 772cf4e2 00000000 00000000 ntdll!__RtlUserThreadStart+0x70
0381f8cc 00000000 772cf4e2 00000000 00000000 ntdll!_RtlUserThreadStart+0x1b
0:006> dd 0022ef74 L4
0022ef74  00000108 00000110 00000114 00000118
0:006> !handle 108 f
Handle 108
  Type         	Thread
  Attributes   	0
  GrantedAccess	0x1fffff:
         Delete,ReadControl,WriteDac,WriteOwner,Synch
         Terminate,Suspend,Alert,GetContext,SetContext,SetInfo,QueryInfo,SetToken,Impersonate,DirectImpersonate
  HandleCount  	4
  PointerCount 	7
  Name         	<none>
  Object Specific Information
    Thread Id   e00.22c8
    Priority    10
    Base Priority 0
    Start Address 12719b0 BatteryMeter!CPUSelectorThread
0:006> !handle 110 f
Handle 110
  Type         	Thread
  Attributes   	0
  GrantedAccess	0x1fffff:
         Delete,ReadControl,WriteDac,WriteOwner,Synch
         Terminate,Suspend,Alert,GetContext,SetContext,SetInfo,QueryInfo,SetToken,Impersonate,DirectImpersonate
  HandleCount  	4
  PointerCount 	7
  Name         	<none>
  Object Specific Information
    Thread Id   e00.22c0
    Priority    10
    Base Priority 0
    Start Address 12719f0 BatteryMeter!HardwareChangeDetectorThread
0:006> !handle 114 f
Handle 114
  Type         	Thread
  Attributes   	0
  GrantedAccess	0x1fffff:
         Delete,ReadControl,WriteDac,WriteOwner,Synch
         Terminate,Suspend,Alert,GetContext,SetContext,SetInfo,QueryInfo,SetToken,Impersonate,DirectImpersonate
  HandleCount  	4
  PointerCount 	8
  Name         	<none>
  Object Specific Information
    Thread Id   e00.179c
    Priority    10
    Base Priority 0
    Start Address 1271a30 BatteryMeter!LocationAwarenessThread
0:006> !handle 118 f
Handle 118
  Type         	Thread
  Attributes   	0
  GrantedAccess	0x1fffff:
         Delete,ReadControl,WriteDac,WriteOwner,Synch
         Terminate,Suspend,Alert,GetContext,SetContext,SetInfo,QueryInfo,SetToken,Impersonate,DirectImpersonate
  HandleCount  	4
  PointerCount 	7
  Name         	<none>
  Object Specific Information
    Thread Id   e00.1854
    Priority    10
    Base Priority 0
    Start Address 1271a60 BatteryMeter!TemperaturePropagationThread
0:006> !handle 11c f
Handle 11c
  Type         	Event
  Attributes   	0
  GrantedAccess	0x1f0003:
         Delete,ReadControl,WriteDac,WriteOwner,Synch
         QueryState,ModifyState
  HandleCount  	3
  PointerCount 	6
  Name         	\Sessions\1\BaseNamedObjects\LocationChangeEvent
  Object Specific Information
    Event Type Manual Reset
    Event is Waiting
0:006> !handle 114 f
Handle 114
  Type         	Thread
  Attributes   	0
  GrantedAccess	0x1fffff:
         Delete,ReadControl,WriteDac,WriteOwner,Synch
         Terminate,Suspend,Alert,GetContext,SetContext,SetInfo,QueryInfo,SetToken,Impersonate,DirectImpersonate
  HandleCount  	4
  PointerCount 	8
  Name         	<none>
  Object Specific Information
    Thread Id   e00.179c
    Priority    10
    Base Priority 0
    Start Address 1271a30 BatteryMeter!LocationAwarenessThread
0:006> !cs -l -o
-----------------------------------------
DebugInfo          = 0x004ba848
Critical section   = 0x012754e8 (BatteryMeter!g_HardwareCS+0x0)
LOCKED
LockCount          = 0x1
WaiterWoken        = No
OwningThread       = 0x000022c0
RecursionCount     = 0x1
LockSemaphore      = 0x120
SpinCount          = 0x00000000
OwningThread DbgId = ~3s
OwningThread Stack =
	ChildEBP RetAddr  Args to Child              
	00ccfd08 77268c44 00000124 00000000 00000000 ntdll!ZwWaitForSingleObject+0x15 (FPO: [3,0,0])
	00ccfd6c 77268b28 00000000 00000000 00000000 ntdll!RtlpWaitOnCriticalSection+0x13e (FPO: [2,17,4])
	00ccfd94 01271a0d 01275500 00000000 76513677 ntdll!RtlEnterCriticalSection+0x150 (FPO: [1,3,4])
	00ccfda0 76513677 00000000 00ccfdec 77269d42 BatteryMeter!HardwareChangeDetectorThread+0x1d (FPO: [1,0,4]) (CONV: stdcall)
	00ccfdac 77269d42 00000000 5e9cf132 00000000 kernel32!BaseThreadInitThunk+0xe (FPO: [1,0,0])
	00ccfdec 77269d15 012719f0 00000000 00000000 ntdll!__RtlUserThreadStart+0x70 (FPO: [SEH])
	00ccfe04 00000000 012719f0 00000000 00000000 ntdll!_RtlUserThreadStart+0x1b (FPO: [2,2,0])
-----------------------------------------
DebugInfo          = 0x004ba870
Critical section   = 0x01275500 (BatteryMeter!g_SelectorCS+0x0)
LOCKED
LockCount          = 0x1
WaiterWoken        = No
OwningThread       = 0x000022c8
RecursionCount     = 0x1
LockSemaphore      = 0x124
SpinCount          = 0x00000000
OwningThread DbgId = ~2s
OwningThread Stack =
	ChildEBP RetAddr  Args to Child              
	00a3fec8 77268c44 00000120 00000000 00000000 ntdll!ZwWaitForSingleObject+0x15 (FPO: [3,0,0])
	00a3ff2c 77268b28 00000000 00000000 00000000 ntdll!RtlpWaitOnCriticalSection+0x13e (FPO: [2,17,4])
	00a3ff54 012719cd 012754e8 00000000 76513677 ntdll!RtlEnterCriticalSection+0x150 (FPO: [1,3,4])
	00a3ff60 76513677 00000000 00a3ffac 77269d42 BatteryMeter!CPUSelectorThread+0x1d (FPO: [1,0,4]) (CONV: stdcall)
	00a3ff6c 77269d42 00000000 5ef3f372 00000000 kernel32!BaseThreadInitThunk+0xe (FPO: [1,0,0])
	00a3ffac 77269d15 012719b0 00000000 00000000 ntdll!__RtlUserThreadStart+0x70 (FPO: [SEH])
	00a3ffc4 00000000 012719b0 00000000 00000000 ntdll!_RtlUserThreadStart+0x1b (FPO: [2,2,0])
-----------------------------------------
DebugInfo          = 0x004ba898
Critical section   = 0x01275518 (BatteryMeter!g_UpdaterCS+0x0)
LOCKED
LockCount          = 0x0
WaiterWoken        = No
OwningThread       = 0x000006dc
RecursionCount     = 0x1
LockSemaphore      = 0x0
SpinCount          = 0x00000000
OwningThread DbgId = ~1s
OwningThread Stack =
	ChildEBP RetAddr  Args to Child              
	02c2fb38 76341d7e 00070ca2 00000408 00000000 USER32!NtUserMessageCall+0x15 (FPO: [7,0,0])
	02c2fb78 7633cd81 013aede0 00000000 52460d85 USER32!SendMessageWorker+0x3c6 (FPO: [6,4,4])
	02c2fb9c 01271761 00070ca2 00000408 00000000 USER32!SendMessageW+0x7f (FPO: [4,0,4])
	02c2fbdc 76513677 0022f728 02c2fc28 77269d42 BatteryMeter!TemperatureAndBatteryUpdaterThread+0xd1 (FPO: [Non-Fpo]) (CONV: stdcall)
	02c2fbe8 77269d42 0022f728 5c92f0f6 00000000 kernel32!BaseThreadInitThunk+0xe (FPO: [1,0,0])
	02c2fc28 77269d15 01271690 0022f728 00000000 ntdll!__RtlUserThreadStart+0x70 (FPO: [SEH])
	02c2fc40 00000000 01271690 0022f728 00000000 ntdll!_RtlUserThreadStart+0x1b (FPO: [2,2,0])
0:006> q
quit:
