1. Run the BatteryMeter.exe application.

2. After a few moments, files begin to pile up in the application's execution directory. Try deleting one of the files while the application is running.

3. Open Process Explorer and view the handles of the BatteryMeter.exe process. Try closing one of the handles to the files you saw in the previous step and see if the application is affected.

4. Now we will diagnose the "file leak" in two ways. First, run Process Monitor and look for the stack trace of the file creation events. This should guide you back to the source code.

ALTERNATIVE (recommended):
5. Run WinDbg and attach to the application. Run !htrace -enable.

6. Let the application run and create a few files.

7. Use !handle 0 to see all file handles in the debugger.

8. Pass some of the file handles to the !htrace command (e.g. !htrace 284). You should see the allocating call stack and immediately detect the culprit.