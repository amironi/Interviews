0. Run the BatteryMeter.exe application.

1. Attach a live debugger to the application when it crashes, or capture a crash dump using ADPlus or similar tools.

2. Locate the exception that occurred and its call stack. Do not inspect the application's source code at this time.

3. Use Application Verifier, open the application's executable, and enable the "Heap" tests under the "Basic" category. Disable all other tests and click "Save".
(ALTERNATIVE: Run gflags, go to the Image tab, enter BatteryMeter.exe and then TAB, check the "Enable page heap" checkbox, and click "Apply".)

4. Run the application again from WinDbg. This time, you should see the precise cause of the error.